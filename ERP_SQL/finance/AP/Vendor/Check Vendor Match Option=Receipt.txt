
----------Check Vendor Match Option=Receipt
SELECT b.ORG_ID,c.SEGMENT1 AS Vender_Num,c.VENDOR_NAME Name,b.VENDOR_SITE_CODE,
decode(c.MATCH_OPTION,'R','Receipt Match','P','PO Match') Supplier_Match_Option,
decode(b.MATCH_OPTION,'R','Receipt Match','P','PO Match') Site_Match_Option,
b.VAT_CODE ,a.DUE_DAYS AS Pay_Terms_Day,d.SEGMENT3 AS Pay_Acc,e.SEGMENT3 AS PREPAY_ACC,b.PAY_GROUP_LOOKUP_CODE AS  Pay_Grp 
,b.CREATION_DATE,b.LAST_UPDATE_DATE,f.USER_NAME AS Create_by,b.INVOICE_CURRENCY_CODE Currency,
c.END_DATE_ACTIVE Vendor_End_Date,TRUNC(b.INACTIVE_DATE) Site_Inactive_Date, 
b.INVOICE_CURRENCY_CODE Site_Inc_Curr,b.PAYMENT_CURRENCY_CODE  Site_Pay_Curr, 
c.INVOICE_CURRENCY_CODE    Supplier_Inv_Curr, 
c.PAYMENT_CURRENCY_CODE    Supplier_Pay_Curr, c.VENDOR_NAME_ALT,b.VENDOR_SITE_CODE_ALT
FROM apps.AP_TERMS_LINES a,apps.PO_VENDOR_SITES_ALL b,apps.PO_VENDORS c,apps.GL_CODE_combinations d 
,apps.GL_CODE_combinations e,apps.FND_USER f 
WHERE a.TERM_ID=b.TERMS_ID 
AND b.ACCTS_PAY_CODE_COMBINATION_ID=d.CODE_COMBINATION_ID 
AND b.PREPAY_CODE_COMBINATION_ID=e.CODE_COMBINATION_ID 
AND b.VENDOR_ID=c.VENDOR_ID 
AND b.CREATED_BY =f.USER_ID 
and VENDOR_TYPE_LOOKUP_CODE<>'EMPLOYEE' 
and (c.MATCH_OPTION='R' or b.MATCH_OPTION='R')
--and ((b.PAY_GROUP_LOOKUP_CODE 'EM' and (b.PAY_GROUP_LOOKUP_CODE 'RH')) or (b.PAY_GROUP_LOOKUP_CODE   is null)) 
and (c.END_DATE_ACTIVE>sysdate or c.END_DATE_ACTIVE is null)
and (b.INACTIVE_DATE>sysdate or b.INACTIVE_DATE is null)
ORDER BY b.ORG_ID,b.VENDOR_ID,b.VENDOR_SITE_CODE
