SELECT A.INVOICE_NUM,C.VENDOR_NAME SUPPLIER,A.INVOICE_CURRENCY_CODE CURRENCY,a.invoice_amount,g.AMOUNT_REMAINING,
---A.INVOICE_AMOUNT,a.AMOUNT_PAID,
round(g.AMOUNT_REMAINING*decode(A.INVOICE_CURRENCY_CODE,'CNY',1,A.EXCHANGE_RATE),2) as Remain_Amt_CNY,
--A.BASE_AMOUNT FUNCTIONAL_AMOUNT,decode(A.INVOICE_CURRENCY_CODE,'CNY',A.INVOICE_AMOUNT,A.BASE_AMOUNT ) as InvoiceAmt_CNY,
A.EXCHANGE_RATE,A.PAY_GROUP_LOOKUP_CODE PAY_GROUP,
A.GL_DATE,a.WFAPPROVAL_STATUS Approve_status,
B.SEGMENT1 AP_COM,B.SEGMENT2 AP_CCC,B.SEGMENT3 AP_ACC,B.SEGMENT4 AP_PRD,B.SEGMENT5 AP_PRJ,B.SEGMENT6 AP_SPA,
A.PAYMENT_STATUS_FLAG Payment_status,e.NAME Payment_term,a.TERMS_DATE,
g.Due_Date,(to_date('2004-07-1','YYYY-MM-DD' )-g.due_date) as Past_Days
FROM APPS.AP_INVOICES_ALL A,apps.GL_CODE_COMBINATIONS_V B,apps.po_vendors C,
apps.AP_TERMS e,apps.AP_TERMS_LINES f,apps.AP_PAYMENT_SCHEDULES_all g
WHERE A.ACCTS_PAY_CODE_COMBINATION_ID=B.CODE_COMBINATION_ID 
AND A.VENDOR_ID=C.VENDOR_ID
and e.term_id=f.term_id
and a.TERMS_ID=e.term_id
and a.invoice_id=g.invoice_id
and a.INVOICE_AMOUNT<>0
and g.PAYMENT_STATUS_FLAG<>'Y'
and gl_date<to_date('2004-07-1','YYYY-MM-DD' )
union
SELECT A.INVOICE_NUM,C.VENDOR_NAME SUPPLIER,A.INVOICE_CURRENCY_CODE CURRENCY,A.INVOICE_AMOUNT,d.AMOUNT,
--(A.INVOICE_AMOUNT-nvl(a.AMOUNT_PAID,0))*decode(A.INVOICE_CURRENCY_CODE,'CNY',1,A.EXCHANGE_RATE) as Remain_Amt_CNY,
round(d.amount*decode(A.INVOICE_CURRENCY_CODE,'CNY',1,A.EXCHANGE_RATE),2) as Remain_Amt_CNY,
--A.BASE_AMOUNT FUNCTIONAL_AMOUNT,decode(A.INVOICE_CURRENCY_CODE,'CNY',A.INVOICE_AMOUNT,A.BASE_AMOUNT ) as InvoiceAmt_CNY,
A.EXCHANGE_RATE,A.PAY_GROUP_LOOKUP_CODE PAY_GROUP,
A.GL_DATE,a.WFAPPROVAL_STATUS Approve_status,
B.SEGMENT1 AP_COM,B.SEGMENT2 AP_CCC,B.SEGMENT3 AP_ACC,B.SEGMENT4 AP_PRD,B.SEGMENT5 AP_PRJ,B.SEGMENT6 AP_SPA,
A.PAYMENT_STATUS_FLAG Payment_status,e.NAME Payment_term,a.TERMS_DATE,
g.Due_Date,(to_date('2004-07-1','YYYY-MM-DD' )-g.DUE_DAte) as Past_Days
FROM APPS.AP_INVOICES_ALL A,apps.GL_CODE_COMBINATIONS_V B,apps.po_vendors C,apps.AP_INVOICE_PAYMENTS_all d,
apps.AP_TERMS e,apps.AP_TERMS_LINES f,apps.AP_PAYMENT_SCHEDULES_all g
WHERE A.ACCTS_PAY_CODE_COMBINATION_ID=B.CODE_COMBINATION_ID 
AND A.VENDOR_ID=C.VENDOR_ID
and e.term_id=f.term_id
and a.TERMS_ID=e.term_id
and a.invoice_id=g.invoice_id
and a.invoice_id=g.invoice_id
and INVOICE_AMOUNT<>0
and g.PAYMENT_STATUS_FLAG<>'N'
and a.gl_date<to_date('2004-07-1','YYYY-MM-DD' )
and d.accounting_date>to_date('2004-07-1','YYYY-MM-DD' )
and a.invoice_id=d.invoice_id
and d.payment_num=g.payment_num


