
--------------Blanket_PO Release's ship line Qty/Amt,item
select pll.LAST_UPDATE_DATE,pll.CREATION_DATE,poh.TYPE_LOOKUP_CODE PO_Type,poh.SEGMENT1 PO,
--poh.REVISION_NUM PO_Rev,por.REVISION_NUM Release_rev,
por.RELEASE_NUM,pol.LINE_NUM,pll.SHIPMENT_NUM,msi.segment1 item,
nvl(pll.QUANTITY_RECEIVED,0)*pol.UNIT_PRICE receive_amt,
por.AUTHORIZATION_STATUS Release_approv,
por.CANCEL_FLAG Release_cancel, pll.CANCEL_FLAG Ship_Cancel,
poh.CURRENCY_CODE,
pol.ITEM_DESCRIPTION,pol.UNIT_PRICE,pll.QUANTITY,pll.QUANTITY_RECEIVED,
pll.SHIP_TO_ORGANIZATION_ID Ship_to_Org
from
apps.PO_HEADERS_ALL POH, 
apps.PO_RELEASES_all POR, 
apps.PO_LINES_all POL, 
apps.PO_LINE_LOCATIONS_all PLL,
apps.mtl_system_items msi
where
por.PO_HEADER_ID=poh.PO_HEADER_ID
and pol.PO_HEADER_ID=poh.PO_HEADER_ID
and pll.PO_HEADER_ID=poh.PO_HEADER_ID
and por.PO_RELEASE_ID=pll.PO_RELEASE_ID
and por.ORG_ID=poh.org_id
and pol.ORG_ID=poh.org_id
and pll.ORG_ID=poh.org_id
and pol.PO_LINE_ID=pll.PO_LINE_ID
and pol.item_id=msi.INVENTORY_ITEM_ID
and msi.ORGANIZATION_ID=pll.SHIP_TO_ORGANIZATION_ID
--and por.APPROVED_FLAG<>'Y'
and poh.SEGMENT1='1091182'
and por.RELEASE_NUM='92'
--and por.CANCEL_FLAG is null
--and pll.CANCEL_FLAG ='Y'--is not null
--and nvl(pll.QUANTITY_RECEIVED,0)*pol.UNIT_PRICE <>0
order by poh.SEGMENT1,por.RELEASE_NUM,pol.LINE_NUM,pll.SHIPMENT_NUM



--------------Blanket_PO Release's ship line Qty/Amt (no item)
select poh.TYPE_LOOKUP_CODE PO_Type,poh.SEGMENT1 PO,
--poh.REVISION_NUM PO_Rev,por.REVISION_NUM Release_rev,
por.RELEASE_NUM,pol.LINE_NUM,pll.SHIPMENT_NUM,
nvl(pll.QUANTITY_RECEIVED,0)*pol.UNIT_PRICE receive_amt,
por.AUTHORIZATION_STATUS Release_approv,
por.CANCEL_FLAG Release_cancel, pll.CANCEL_FLAG Ship_Cancel,
poh.CURRENCY_CODE,
pol.ITEM_DESCRIPTION,pol.UNIT_PRICE,pll.QUANTITY,pll.QUANTITY_RECEIVED,
pll.SHIP_TO_ORGANIZATION_ID Ship_to_Org
from
apps.PO_HEADERS_ALL POH, 
apps.PO_RELEASES_all POR, 
apps.PO_LINES_all POL, 
apps.PO_LINE_LOCATIONS_all PLL
where
por.PO_HEADER_ID=poh.PO_HEADER_ID
and pol.PO_HEADER_ID=poh.PO_HEADER_ID
and pll.PO_HEADER_ID=poh.PO_HEADER_ID
and por.PO_RELEASE_ID=pll.PO_RELEASE_ID
and por.ORG_ID=poh.org_id
and pol.ORG_ID=poh.org_id
and pll.ORG_ID=poh.org_id
and pol.PO_LINE_ID=pll.PO_LINE_ID
--and por.APPROVED_FLAG<>'Y'
and poh.SEGMENT1='1057833'
--and por.RELEASE_NUM='246'
--and por.CANCEL_FLAG is null
--and pll.CANCEL_FLAG ='Y'--is not null
--and nvl(pll.QUANTITY_RECEIVED,0)*pol.UNIT_PRICE <>0
order by poh.SEGMENT1,por.RELEASE_NUM,pol.LINE_NUM,pll.SHIPMENT_NUM



------------Must run this could retrive data from View !!!!!!!!!!!!!
BEGIN
 apps.Fnd_Client_Info.set_org_context('127');
END;


------------Blanket PO line sum Qty of Ordered Qty/Received_Qty/Billed_Qty with release number

select a.po_num,a.RELEASE_NUM,pol.LINE_NUM,sum(b.quantity) Qty,sum(b.quantity_billed) Billed_qty,
sum(b.quantity_received) Rec_Qty
from  apps.PO_RELEASES_V a,apps.PO_LINE_LOCATIONS_RELEASE_V b,
apps.PO_LINES_ALL pol
where a.po_release_id=b.po_release_id
and a.po_header_id=b.po_header_id
and a.po_header_id=pol.po_header_id
and a.po_num='1038874' -- and pol.LINE_NUM in ('35','36')
and pol.PO_LINE_ID=b.PO_LINE_ID
and a.TYPE_LOOKUP_CODE='BLANKET'
group by a.po_num,pol.LINE_NUM,RELEASE_NUM
having sum(b.quantity_billed)<sum(b.quantity_received)

--old no release number
select a.po_num,pol.LINE_NUM,sum(b.quantity) Qty,sum(b.quantity_billed) Billed_qty,
sum(b.quantity_received) Rec_Qty
from  apps.PO_RELEASES_V a,apps.PO_LINE_LOCATIONS_RELEASE_V b,
apps.PO_LINES_ALL pol
where a.po_release_id=b.po_release_id
and a.po_header_id=b.po_header_id
and a.po_header_id=pol.po_header_id
and a.po_num='1038951' -- and pol.LINE_NUM in ('35','36')
and pol.PO_LINE_ID=b.PO_LINE_ID
and a.TYPE_LOOKUP_CODE='BLANKET'
group by a.po_num,pol.LINE_NUM



------------Blanket PO Open release lines
select a.po_num,pol.LINE_NUM,sum(b.quantity) Qty,sum(b.quantity_billed) Billed_qty,
sum(b.quantity_received) Rec_Qty
from  apps.PO_RELEASES_V a,apps.PO_LINE_LOCATIONS_RELEASE_V b,
apps.PO_LINES_ALL pol
where a.po_release_id=b.po_release_id
and a.po_header_id=b.po_header_id
and a.po_header_id=pol.po_header_id
and a.po_num='1038951' -- and pol.LINE_NUM in ('35','36')
and pol.PO_LINE_ID=b.PO_LINE_ID
and a.TYPE_LOOKUP_CODE='BLANKET'
group by a.po_num,pol.LINE_NUM
having sum(b.quantity)<>sum(b.quantity_received)




---------PO release ship line Qty (Received Qty OK)
select a.TYPE_LOOKUP_CODE,a.po_num,a.release_num,pol.LINE_NUM,b.SHIPMENT_NUM,b.quantity,b.quantity_billed,
b.quantity_received,b.item_id
from  apps.PO_RELEASES_V a,apps.PO_LINE_LOCATIONS_RELEASE_V b,
apps.PO_LINES_ALL pol
where a.po_release_id=b.po_release_id
and a.po_header_id=b.po_header_id
and a.po_header_id=pol.po_header_id
and a.po_num='1038925'  and a.release_num=183
and pol.PO_LINE_ID=b.PO_LINE_ID
and a.TYPE_LOOKUP_CODE='BLANKET'


---------PO release Dist line Qty (Received Qty OK)
select a.TYPE_LOOKUP_CODE,a.po_num,a.release_num,pol.LINE_NUM,b.SHIPMENT_NUM,c.DISTRIBUTION_NUM,
b.item_id,c.QUANTITY_BILLED dist_Bill_Qty,c.QUANTITY_ORDERED Dist_Qty,c.QUANTITY_DELIVERED Dist_Deliv_Qty,c.QUANTITY_CANCELLED Dist_Cancel_Qty,c.SEGMENT1
from  apps.PO_RELEASES_V a,apps.PO_LINE_LOCATIONS_RELEASE_V b,apps.PO_DISTRIBUTIONS_V c,
apps.PO_LINES_ALL pol
where a.po_release_id=b.po_release_id
and a.po_header_id=b.po_header_id
and a.po_header_id=c.po_header_id
and b.LINE_LOCATION_ID=c.LINE_LOCATION_ID
and a.po_header_id=pol.po_header_id
and a.po_release_id=c.po_release_id
and a.po_num='1038925'  and a.release_num=183
and pol.PO_LINE_ID=b.PO_LINE_ID
and pol.PO_LINE_ID=c.PO_LINE_ID
and a.TYPE_LOOKUP_CODE='BLANKET'


------------Find all Blanket PO receive/Bill count(*)
select count(*),a.po_num,a.release_num from 
(
select a.po_num,a.release_num,decode(c.QUANTITY_BILLED,0,0,1) Billed,count(*),decode(c.QUANTITY_ORDERED-c.QUANTITY_DELIVERED,0,1,0) Received
from  apps.PO_RELEASES_V a,apps.PO_LINE_LOCATIONS_RELEASE_V b,apps.PO_DISTRIBUTIONS_V c,
apps.PO_LINES_ALL pol,apps.ap_invoices_all api,apps.AP_INVOICE_DISTRIBUTIONS_all apd
where a.po_release_id=b.po_release_id
and a.po_header_id=b.po_header_id
and a.po_header_id=c.po_header_id
and b.LINE_LOCATION_ID=c.LINE_LOCATION_ID
and a.po_header_id=pol.po_header_id
and a.po_release_id=c.po_release_id
--and a.po_num='1038925'  --and a.release_num=183
and pol.PO_LINE_ID=b.PO_LINE_ID
and pol.PO_LINE_ID=c.PO_LINE_ID
and api.INVOICE_ID(+)=apd.INVOICE_ID
and apd.po_distribution_id(+)=c.po_distribution_id
--and c.QUANTITY_BILLED<>0
--and pol.LINE_NUM=64
and a.TYPE_LOOKUP_CODE='BLANKET'
group by a.po_num,decode(c.QUANTITY_BILLED,0,0,1),decode(c.QUANTITY_ORDERED-c.QUANTITY_DELIVERED,0,1,0),a.release_num,a.TYPE_LOOKUP_CODE
) a 
group by a.po_num,a.release_num
having count(*)>1




---------PO Release Header
select b.segment1 PO,a.RELEASE_NUM,a.APPROVED_FLAG,a.AUTHORIZATION_STATUS,a.CANCEL_FLAG,a.CANCEL_DATE,a.CREATION_DATE,
a.RELEASE_DATE,a.RELEASE_TYPE,a.ORG_ID,a.PO_HEADER_ID,a.PO_RELEASE_ID
from apps.PO_RELEASES_ALL a,apps.po_headers_all b
where a.PO_HEADER_ID=b.PO_HEADER_ID


select * from apps.PO_RELEASES_ALL

select * from apps.PO_LINE_LOCATIONS_RELEASE_V 



---------PO Release Header with User name
BEGIN
 apps.Fnd_Client_Info.set_org_context('127');
END;


select CREATION_DATE,RELEASE_DATE,START_DATE,APPROVED_DATE,REVISED_DATE,AGENT_NAME,AGREEMENT_BUYER,
AGREEMENT_STATUS,AGREEMENT_TYPE ,AMOUNT_AGREED,APPROVED_FLAG,CANCEL_DATE,CANCEL_FLAG,CLOSED_CODE ,PO_NUM,RELEASE_NUM,
STATUS, TOTAL,TOTAL_RELEASED,TYPE_LOOKUP_CODE,VENDOR_NAME                    
from apps.PO_RELEASES_V

select * from apps.PO_RELEASES_V


FROM 
FINANCIALS_SYSTEM_PARAMETERS FSP , 
ORG_ORGANIZATION_DEFINITIONS OOD , 
HR_LOCATIONS_ALL_TL HRLT , 
HR_LOCATIONS_ALL HRL , 
PO_VENDOR_SITES PVS , 
PER_PEOPLE_F PPF , 
PO_VENDORS POV , 
PO_HEADERS POH , 
PO_RELEASES POR , 
PO_DOCUMENT_TYPES_ALL_B PDTB , 
PO_DOCUMENT_TYPES_ALL_TL PDTL , 
PER_PEOPLE_F PPF2 , 
PO_VENDOR_CONTACTS PVC , A
P_TERMS APT , 
PO_LOOKUP_CODES POLC , 
PO_LOOKUP_CODES POLC2 , 
PO_LOOKUP_CODES POLC3 , 
PO_LOOKUP_CODES POLC4 

WHERE POR.PO_HEADER_ID = POH.PO_HEADER_ID 
AND POH.VENDOR_ID = POV.VENDOR_ID 
AND POH.VENDOR_SITE_ID = PVS.VENDOR_SITE_ID 
AND POR.AGENT_ID = PPF.PERSON_ID 
AND PPF.EMPLOYEE_NUMBER IS NOT NULL 
AND TRUNC(SYSDATE) BETWEEN PPF.EFFECTIVE_START_DATE 
AND PPF.EFFECTIVE_END_DATE 
AND POH.SHIP_TO_LOCATION_ID = HRL.LOCATION_ID 
AND OOD.ORGANIZATION_ID(+) = HRL.INVENTORY_ORGANIZATION_ID 
AND NVL(HRL.BUSINESS_GROUP_ID(+),NVL(HR_GENERAL.GET_BUSINESS_GROUP_ID,-99)) = NVL(HR_GENERAL.GET_BUSINESS_GROUP_ID,-99) 
AND HRL.LOCATION_ID = HRLT.LOCATION_ID(+) AND HRLT.LANGUAGE(+) = USERENV('LANG') 
AND (OOD.SET_OF_BOOKS_ID IS NULL OR OOD.SET_OF_BOOKS_ID = FSP.SET_OF_BOOKS_ID) 
AND PDTB.document_type_code in ('PO', 'PA') 
AND PDTB.document_subtype = POH.type_lookup_code
 AND PDTB.DOCUMENT_TYPE_CODE = PDTL.DOCUMENT_TYPE_CODE(+) 
AND PDTB.DOCUMENT_SUBTYPE = PDTL.DOCUMENT_SUBTYPE(+) 
AND NVL(PDTB.ORG_ID,-99) = NVL(PDTL.ORG_ID,-99) 
AND NVL(PDTB.ORG_ID,NVL(TO_NUMBER(DECODE(SUBSTRB(USERENV('CLIENT_INFO'),1,1), ' ', NULL,SUBSTRB(USERENV('CLIENT_INFO'),1,10))),-99)) = NVL (TO_NUMBER(DECODE(SUBSTRB(USERENV('CLIENT_INFO'),1,1),' ',NULL, SUBSTRB(USERENV('CLIENT_INFO'),1,10))),-99) AND PDTL.LANGUAGE(+) = USERENV('LANG') AND PPF2.person_id = POH.agent_id AND PPF2.employee_number is not null AND trunc(sysdate) between PPF2.effective_start_date and PPF2.effective_end_date AND POH.vendor_contact_id = PVC.vendor_contact_id (+) AND APT.term_id (+) = POH.terms_id AND nvl(POH.authorization_status,'INCOMPLETE') =POLC.lookup_code(+) AND POLC.lookup_type(+) = 'AUTHORIZATION STATUS' AND POLC2.lookup_code (+) = POH.fob_lookup_code AND POLC2.lookup_type (+) = 'FOB' AND POLC3.lookup_code (+) = POH.freight_terms_lookup_code AND POLC3.lookup_type (+) = 'FREIGHT TERMS' AND POLC4.LOOKUP_CODE (+) = POR.PAY_ON_CODE AND POLC4.LOOKUP_TYPE (+) = 'PAY ON CODE';



-----PO release ship line

select * from apps.PO_LINE_LOCATIONS_RELEASE_V 


SELECT PLL.ROWID , PLL.PO_HEADER_ID , PLL.PO_LINE_ID , POL.LINE_NUM , PLL.PO_RELEASE_ID , PLL.LINE_LOCATION_ID , PLL.SOURCE_SHIPMENT_ID , PLL2.SHIPMENT_NUM , PLL.SHIPMENT_NUM , PLL.SHIPMENT_TYPE , PLL.SHIP_TO_ORGANIZATION_ID , OOD.ORGANIZATION_CODE , PLL.SHIP_TO_LOCATION_ID , HRL.LOCATION_CODE , PLL.QUANTITY , PLL.QUANTITY_ACCEPTED , PLL.QUANTITY_BILLED , PLL.QUANTITY_CANCELLED , PLL.QUANTITY_RECEIVED , PLL.QUANTITY_REJECTED , POL.UNIT_MEAS_LOOKUP_CODE , PLL.PRICE_OVERRIDE , POL.UNIT_PRICE , POL.NOT_TO_EXCEED_PRICE , POL.ALLOW_PRICE_OVERRIDE_FLAG , POL.PRICE_BREAK_LOOKUP_CODE , PLL.QUANTITY*PLL.PRICE_OVERRIDE , PO_HEADERS_SV3.GET_CURRENCY_CODE(PLL.PO_HEADER_ID) , PLL.LAST_ACCEPT_DATE , PLL.NEED_BY_DATE , PLL.PROMISED_DATE , PLL.FIRM_STATUS_LOOKUP_CODE , PLL.PRICE_DISCOUNT , PLL.START_DATE , PLL.END_DATE , PLL.LEAD_TIME , PLL.LEAD_TIME_UNIT , PLL.TERMS_ID , APT.NAME , PLL.FREIGHT_TERMS_LOOKUP_CODE , PLL.FOB_LOOKUP_CODE , PLL.SHIP_VIA_LOOKUP_CODE , ATC.NAME , PLL.TAXABLE_FLAG , PLL.INSPECTION_REQUIRED_FLAG , PLL.RECEIPT_REQUIRED_FLAG , PLL.RECEIVE_CLOSE_TOLERANCE , PLL.INVOICE_CLOSE_TOLERANCE , PLL.QTY_RCV_EXCEPTION_CODE , PLL.DAYS_EARLY_RECEIPT_ALLOWED , PLL.DAYS_LATE_RECEIPT_ALLOWED , PLL.QTY_RCV_TOLERANCE , PLL.RECEIVING_ROUTING_ID , PLL.ENFORCE_SHIP_TO_LOCATION_CODE , PLL.RECEIPT_DAYS_EXCEPTION_CODE , PLL.ACCRUE_ON_RECEIPT_FLAG , PLL.ALLOW_SUBSTITUTE_RECEIPTS_FLAG , PLL.FROM_HEADER_ID , PLL.FROM_LINE_ID , PLL.FROM_LINE_LOCATION_ID , NVL(PLL.ENCUMBERED_FLAG, 'N') , PLL.ENCUMBERED_DATE , PLL.APPROVED_FLAG , PLL.APPROVED_DATE , PLL.CLOSED_CODE , DECODE(NVL(PLL.CLOSED_CODE,'OPEN'),'OPEN', NULL, POLC1.DISPLAYED_FIELD)||DECODE(PLL.CANCEL_FLAG,'Y',','||''|| POLC2.DISPLAYED_FIELD, NULL) , PLL.CANCEL_FLAG , PLL.CANCEL_DATE , PLL.CANCEL_REASON , PLL.CANCELLED_BY , PLL.CLOSED_FLAG , PLL.CLOSED_BY , PLL.CLOSED_DATE , PLL.CLOSED_REASON , PLL.USSGL_TRANSACTION_CODE , PLL.GOVERNMENT_CONTEXT , POL.LINE_TYPE_ID , PLT.LINE_TYPE , PLT.OUTSIDE_OPERATION_FLAG , PLT.RECEIVING_FLAG , POL.ITEM_ID , POL.ITEM_DESCRIPTION , POL.ITEM_REVISION , DECODE(MSI.MRP_PLANNING_CODE, 3, 'Y', 4, 'Y', DECODE(MSI.INVENTORY_PLANNING_CODE, 1, 'Y', 2, 'Y','N')) , MSI.STOCK_ENABLED_FLAG , MSI.OUTSIDE_OPERATION_UOM_TYPE , MCA.CONCATENATED_SEGMENTS , POL.CATEGORY_ID , POL.VENDOR_PRODUCT_NUM , PLL.LAST_UPDATE_DATE , PLL.LAST_UPDATED_BY , PLL.LAST_UPDATE_LOGIN , PLL.CREATED_BY , PLL.CREATION_DATE , PLL.PROGRAM_ID , PLL.REQUEST_ID , PLL.PROGRAM_APPLICATION_ID , PLL.PROGRAM_UPDATE_DATE , PLL.ATTRIBUTE1 , PLL.ATTRIBUTE2 , PLL.ATTRIBUTE3 , PLL.ATTRIBUTE4 , PLL.ATTRIBUTE5 , PLL.ATTRIBUTE6 , PLL.ATTRIBUTE7 , PLL.ATTRIBUTE8 , PLL.ATTRIBUTE9 , PLL.ATTRIBUTE10 , PLL.ATTRIBUTE11 , PLL.ATTRIBUTE12 , PLL.ATTRIBUTE13 , PLL.ATTRIBUTE14 , PLL.ATTRIBUTE15 , PLL.ATTRIBUTE_CATEGORY ,PLL.GLOBAL_ATTRIBUTE_CATEGORY ,PLL.GLOBAL_ATTRIBUTE1 ,PLL.GLOBAL_ATTRIBUTE2 ,PLL.GLOBAL_ATTRIBUTE3 ,PLL.GLOBAL_ATTRIBUTE4 ,PLL.GLOBAL_ATTRIBUTE5 ,PLL.GLOBAL_ATTRIBUTE6 ,PLL.GLOBAL_ATTRIBUTE7 ,PLL.GLOBAL_ATTRIBUTE8 ,PLL.GLOBAL_ATTRIBUTE9 ,PLL.GLOBAL_ATTRIBUTE10 ,PLL.GLOBAL_ATTRIBUTE11 ,PLL.GLOBAL_ATTRIBUTE12 ,PLL.GLOBAL_ATTRIBUTE13 ,PLL.GLOBAL_ATTRIBUTE14 ,PLL.GLOBAL_ATTRIBUTE15 ,PLL.GLOBAL_ATTRIBUTE16 ,PLL.GLOBAL_ATTRIBUTE17 ,PLL.GLOBAL_ATTRIBUTE18 ,PLL.GLOBAL_ATTRIBUTE19 ,PLL.GLOBAL_ATTRIBUTE20 ,PLL.MATCH_OPTION ,PLL.COUNTRY_OF_ORIGIN_CODE ,PLL.TAX_USER_OVERRIDE_FLAG ,PLL.TAX_CODE_ID ,PLL.CALCULATE_TAX_FLAG ,PLL.NOTE_TO_RECEIVER ,POL.OKE_CONTRACT_HEADER_ID ,PLL.SECONDARY_UNIT_OF_MEASURE ,PLL.SECONDARY_QUANTITY ,PLL.PREFERRED_GRADE ,PLL.SECONDARY_QUANTITY_RECEIVED ,PLL.SECONDARY_QUANTITY_ACCEPTED ,PLL.SECONDARY_QUANTITY_REJECTED ,PLL.SECONDARY_QUANTITY_CANCELLED ,PLL.VMI_FLAG 

FROM 
PO_LOOKUP_CODES POLC1, 
PO_LOOKUP_CODES POLC2, 
PO_LINE_TYPES PLT, 
HR_LOCATIONS_ALL_TL HRL, 
ORG_ORGANIZATION_DEFINITIONS OOD, 
AP_TERMS APT, 
AP_TAX_CODES ATC, 
MTL_SYSTEM_ITEMS MSI, 
FINANCIALS_SYSTEM_PARAMETERS FSP, 
MTL_CATEGORIES_KFV MCA, 
PO_LINE_LOCATIONS PLL2, 
PO_LINES POL, 
PO_LINE_LOCATIONS PLL 
WHERE PLL.PO_LINE_ID = POL.PO_LINE_ID 
AND POL.ITEM_ID = MSI.INVENTORY_ITEM_ID (+) 
AND NVL(MSI.ORGANIZATION_ID,FSP.INVENTORY_ORGANIZATION_ID) = FSP.INVENTORY_ORGANIZATION_ID 
AND POL.CATEGORY_ID = MCA.CATEGORY_ID 
AND PLL.SOURCE_SHIPMENT_ID = PLL2.LINE_LOCATION_ID (+) 
AND PLL.SHIPMENT_TYPE IN ('SCHEDULED', 'BLANKET') 
AND HRL.LOCATION_ID (+) = PLL.SHIP_TO_LOCATION_ID 
AND HRL.LANGUAGE(+) = USERENV('LANG') 
AND OOD.ORGANIZATION_ID(+) = PLL.SHIP_TO_ORGANIZATION_ID 
AND APT.TERM_ID (+) = PLL.TERMS_ID 
AND POL.LINE_TYPE_ID = PLT.LINE_TYPE_ID 
AND POLC1.LOOKUP_TYPE(+) = 'DOCUMENT STATE'||decode(pll.rowid, null, '', '') 
AND POLC1.LOOKUP_CODE(+) = NVL(PLL.CLOSED_CODE, 'OPEN') 
AND POLC2.LOOKUP_TYPE (+) = 'DOCUMENT STATE' 
AND POLC2.LOOKUP_CODE (+) = 'CANCELLED'||decode(pll.rowid, null, '', '') 
AND PLL.TAX_CODE_ID = ATC.TAX_ID(+);


